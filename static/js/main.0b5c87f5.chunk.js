(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{18:function(e,t,c){"use strict";c.r(t);var n=c(1),i=c(8),r=c(3),s=c(2);c(4);var a=c(0),o=null,l=[[100,100]];function h(e){var t=Object(n.useRef)(null),c=1.5,i=function(e,t){l.push([e[0]+t*(Math.random()-.5),e[1]+t*(Math.random()-.5)])},h=function(t){for(var c=e.uv[0],n=e.uv[1],i=0;i<e.vortices.length;++i){var r=e.vortices[i],s=(t[0]-r[0])/100,a=(t[1]-r[1])/100,o=s*s+a*a;"source"==r[3]?(c+=r[2]*s/100/o,n+=r[2]*a/100/o):(c+=r[2]*a/100/o,n-=r[2]*s/100/o)}return[c,n]},u=function(e){var t=h(e),n=h([e[0]+t[0]*c/2,e[1]+t[1]*c/2]);e[0]+=n[0]*c,e[1]+=n[1]*c},j=document.createElement("canvas");j.width=e.width,j.height=e.height;var v=function(e){if(4==e.toString().length){var t=parseInt(e.toString()[0])/10,c=parseInt(e.toString()[1])/10,n=parseInt(e.toString().substr(2))/100;if(isNaN(t)||isNaN(c)||isNaN(n))return null;var i=function(e){return 5*n*(.2969*Math.sqrt(e)-.126*e-.3516*e*e+.2843*e*e*e-.1015*e*e*e*e)},r=function(e){return e<=c?t*t/(c*c)*(2*c*e-e*e):t*t/((1-c)*(1-c))*(1-2*c+2*c*e-e*e)},a=Math.round(6/n),o=Object(s.a)(Array(2*a+1).keys()).map((function(e){return e/a*(e/a)/(2+e/a)}));o.reverse();var l=o.map((function(e){return[e,r(e)+i(e)]}));return o.reverse(),o.splice(0,1),l.push.apply(l,Object(s.a)(o.map((function(e){return[e,r(e)-i(e)]})))),l}return null}(e.airfoil),d=function(){var c=j.getContext("2d");c.clearRect(0,0,e.width,e.height),c.fillStyle="#000000";for(var n=0;n<l.length;++n){var i=l[n];c.fillRect(i[0],i[1],1,1)}!function(t){for(var c=0;c<e.vortices.length;++c){var n=[parseInt(e.vortices[c][0]),parseInt(e.vortices[c][1])];e.iselect==c?(t.strokeStyle="#880000",t.beginPath(),t.moveTo(n[0],Math.max(1,n[1]-15)),t.lineTo(n[0],Math.min(e.height,n[1]+15)),t.stroke(),t.beginPath(),t.moveTo(Math.max(1,n[0]-15),n[1]),t.lineTo(Math.min(e.width,n[0]+15),n[1]),t.stroke(),t.fillStyle="#880000",t.beginPath(),t.arc(n[0],n[1],3,0,2*Math.PI)):(t.fillStyle="#008800",t.beginPath(),t.arc(n[0],n[1],3,0,2*Math.PI)),t.fill()}}(c),function(t){if(null!=v){var c=.7*e.width;t.strokeStyle="#888888",t.beginPath(),t.moveTo(.15*e.width+v[0][0]*c,e.height/2-v[0][1]*c);for(var n=1;n<v.length;++n)t.lineTo(.15*e.width+v[n][0]*c,e.height/2-v[n][1]*c);t.stroke()}}(c);var r=t.current.getContext("2d");r.clearRect(0,0,e.width,e.height),r.drawImage(j,0,0)};Object(n.useEffect)((function(){null!=o&&clearInterval(o),o=setInterval((function(){!function(){for(var t=0;t<l.length;++t)u(l[t]);l=l.filter((function(t){return Math.random()>.001&&isFinite(t[0])&&isFinite(t[1])&&t[0]>.2*-e.width&&t[0]<1.2*e.width&&t[1]>.2*-e.height&&t[1]<1.2*e.height}));for(var n=function(t){if("source"==e.vortices[t][3]&&e.vortices[t][2]<0){var n=parseInt(e.vortices[t][0]),i=parseInt(e.vortices[t][1]);l=l.filter((function(r){var s=r[0]-n,a=r[1]-i;return s*s+a*a>-.15*c*e.vortices[t][2]}))}},r=0;r<e.vortices.length;++r)n(r);for(var s=Math.max(.01,e.uv[0]),a=Math.max(.01,-e.uv[1]),o=3/Math.sqrt(s*s+a*a),h=e.height-e.spacing/s*e.delta;h>.2*-e.height;h-=e.spacing/s)i([0,h],o);for(var j=e.spacing/a*(1-e.delta);j<1.2*e.width;j+=e.spacing/a)i([j,e.height],o);for(var v=0;v<e.vortices.length;++v)if("source"==e.vortices[v][3]&&e.vortices[v][2]>0)for(var d=parseInt(e.vortices[v][0]),b=parseInt(e.vortices[v][1]),x=3*Math.ceil(2.07*e.vortices[v][2]/e.spacing),O=.1*e.vortices[v][2]*c,g=0;g<x;++g){var f=O+(Math.random()-.5)*c*4,p=d+f*Math.cos(2*g*Math.PI/x),m=b+f*Math.sin(2*g*Math.PI/x);console.log(p,m),i([p,m],.5*e.vortices[v][2]/1e3)}}(),d()}),30)}),[e]);return Object(a.jsx)("canvas",{ref:t,onMouseMove:function(c){var n=t.current,i=n.getBoundingClientRect(),s=n.width/i.width,a=n.height/i.height,o=(c.clientX-i.left)*s,l=(c.clientY-i.top)*a,u=h([o,l]),j=Object(r.a)(u,2),v=j[0],d=j[1],b=.5*(e.uv[0]*e.uv[0]+e.uv[1]*e.uv[1]-v*v-d*d);e.setmousestate([o,l,v,-d,b])},onMouseLeave:function(){e.setmousestate([])},width:e.width,height:e.height})}function u(e){var t=function(t){var c=Object(s.a)(e.vortices);c[e.selected][0]=t.target.value,e.setvortices(c)},c=function(t){var c=Object(s.a)(e.vortices);c[e.selected][1]=e.height-t.target.value,e.setvortices(c)},n=function(t){var c=Object(s.a)(e.vortices);c[e.selected][2]=Math.max(-100,Math.min(100,t.target.value)),e.setvortices(c)},i=function(t){var c=Object(s.a)(e.vortices);c[e.selected][3]=t.target.value,e.setvortices(c)},r=function(){var t=Object(s.a)(e.vortices);t.splice(e.selected,0,Object(s.a)(t[e.selected])),e.setvortices(t)},o=function(){var t=Object(s.a)(e.vortices);t.splice(e.selected,1),console.log(e.selected,t.length),e.setvortices(t)};return Object(a.jsx)("div",{children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"x"}),Object(a.jsx)("th",{children:"y"}),Object(a.jsx)("th",{children:"strength"})]}),e.vortices.map((function(s,l){return Object(a.jsxs)("tr",{onFocus:function(){e.setselected(l)},onClick:function(){e.setselected(l)},onTouchStart:function(){e.setselected(l)},children:[Object(a.jsx)("td",{children:Object(a.jsx)("input",{type:"number",value:s[0],onChange:t,min:0,max:e.width,readOnly:l!=e.selected})}),Object(a.jsx)("td",{children:Object(a.jsx)("input",{type:"number",value:e.height-s[1],onChange:c,min:0,max:e.height,readOnly:l!=e.selected})}),Object(a.jsx)("td",{children:Object(a.jsx)("input",{type:"number",value:s[2],onChange:n,min:-100,max:100,readOnly:l!=e.selected})}),Object(a.jsx)("td",{children:Object(a.jsxs)("select",{value:s[3],onChange:i,children:[Object(a.jsx)("option",{value:"vortex",children:"vortex"}),Object(a.jsx)("option",{value:"source",children:"source"})]})}),Object(a.jsxs)("td",{children:[" ",l==e.selected?Object(a.jsx)("button",{onClick:r,children:"duplicate"}):Object(a.jsx)("span",{})]}),Object(a.jsxs)("td",{children:[" ",l==e.selected?Object(a.jsx)("button",{disabled:e.vortices.length<=1,onClick:o,children:"remove"}):Object(a.jsx)("span",{})]})]},l)}))]})})})}function j(e){return Object(a.jsxs)("div",{children:[Object(a.jsxs)("p",{children:[" ","u",Object(a.jsx)("sub",{children:"\u221e"})," ",Object(a.jsx)("input",{type:"number",step:.001,value:e.uv[0],onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setuv([c,e.uv[1]])},min:0,max:1}),"   ","v",Object(a.jsx)("sub",{children:"\u221e"})," ",Object(a.jsx)("input",{type:"number",step:.001,value:-e.uv[1],onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setuv([e.uv[0],-c])},min:0,max:1})," ","   ","\u03b4"," ",Object(a.jsx)("input",{type:"number",step:.01,value:e.delta,onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setdelta(c)},min:0,max:1})]}),Object(a.jsxs)("p",{children:[" naca ",Object(a.jsx)("input",{type:"text",value:e.airfoil,onChange:function(t){e.setairfoil(t.target.value)},min:0,max:1})]})]})}function v(e){return 0==e.mousestate.length?Object(a.jsx)("div",{}):Object(a.jsxs)("div",{children:[Object(a.jsxs)("p",{children:["x=",e.mousestate[0].toFixed(0)]}),Object(a.jsxs)("p",{children:["y=",e.mousestate[1].toFixed(0)]}),Object(a.jsxs)("p",{children:["u=",e.mousestate[2].toFixed(2)]}),Object(a.jsxs)("p",{children:["v=",e.mousestate[3].toFixed(2)]}),Object(a.jsxs)("p",{children:["p=",e.mousestate[4].toFixed(2)]})]})}function d(){var e=[1280,720],t=Object(n.useState)([[e[0]/2,e[1]/2,100,"vortex"]]),c=Object(r.a)(t,2),i=c[0],s=c[1],o=Object(n.useState)(0),l=Object(r.a)(o,2),d=l[0],b=l[1],x=Object(n.useState)([1,0]),O=Object(r.a)(x,2),g=O[0],f=O[1],p=Object(n.useState)(0),m=Object(r.a)(p,2),M=m[0],w=m[1],y=Object(n.useState)(""),S=Object(r.a)(y,2),I=S[0],C=S[1],k=Object(n.useState)([]),F=Object(r.a)(k,2),P=F[0],N=F[1];return Object(a.jsx)("div",{className:"FlowBuilder",children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{rowSpan:2,children:Object(a.jsx)("img",{src:"qi.jpg"})}),Object(a.jsx)("td",{children:Object(a.jsx)(u,{vortices:i,selected:d,setvortices:s,setselected:b,width:e[0],height:e[1]})})," ",Object(a.jsx)("td",{rowSpan:2,width:"100px",valign:"bottom",children:Object(a.jsx)(v,{mousestate:P})}),Object(a.jsx)("td",{rowSpan:2,children:Object(a.jsx)("img",{src:"qi.jpg"})})]}),Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:Object(a.jsx)(j,{uv:g,setuv:f,delta:M,setdelta:w,airfoil:I,setairfoil:C})})}),Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:4,children:Object(a.jsx)(h,{width:e[0],height:e[1],uv:g,spacing:20,u0:[1,0],vortices:i,iselect:d,delta:M,airfoil:I,setmousestate:N})})})]})})})}var b=document.getElementById("root");Object(i.createRoot)(b).render(Object(a.jsx)(n.StrictMode,{children:Object(a.jsx)(d,{})}))},4:function(e,t,c){}},[[18,1,2]]]);
//# sourceMappingURL=main.0b5c87f5.chunk.js.map