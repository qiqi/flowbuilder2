(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{19:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c(8),i=c(3),a=c(9),s=c(2);c(5);var o=c(0),l=null,h=[[100,100]];function u(e){var t=Object(n.useRef)(null),c=1.5,r=function(e,t){h.push([e[0]+t*(Math.random()-.5),e[1]+t*(Math.random()-.5)])},i=function(t){for(var c=e.uv[0],n=e.uv[1],r=0;r<e.vortices.length;++r){var i=e.vortices[r],a=(t[0]-i[0])/100,s=(t[1]-i[1])/100,o=a*a+s*s;"source"==i[3]?(c+=i[2]*a/100/o,n+=i[2]*s/100/o):(c+=i[2]*s/100/o,n-=i[2]*a/100/o)}return[c,n]},u=function(e){var t=i(e),n=i([e[0]+t[0]*c/2,e[1]+t[1]*c/2]);e[0]+=n[0]*c,e[1]+=n[1]*c},j=document.createElement("canvas");j.width=e.width,j.height=e.height;var v=function(e){if(4==e.toString().length){var t=parseInt(e.toString()[0])/10,c=parseInt(e.toString()[1])/10,n=parseInt(e.toString().substr(2))/100;if(isNaN(t)||isNaN(c)||isNaN(n))return null;var r=function(e){return 5*n*(.2969*Math.sqrt(e)-.126*e-.3516*e*e+.2843*e*e*e-.1015*e*e*e*e)},i=function(e){return e<=c?t*t/(c*c)*(2*c*e-e*e):t*t/((1-c)*(1-c))*(1-2*c+2*c*e-e*e)},a=Math.round(6/n),o=Object(s.a)(Array(2*a+1).keys()).map((function(e){return e/a*(e/a)/(2+e/a)}));o.reverse();var l=o.map((function(e){return[e,i(e)+r(e)]}));return o.reverse(),o.splice(0,1),l.push.apply(l,Object(s.a)(o.map((function(e){return[e,i(e)-r(e)]})))),l}return null}(e.airfoil),d=function(){var c=j.getContext("2d");c.clearRect(0,0,e.width,e.height),c.fillStyle="#000000";for(var n=0;n<h.length;++n){var r=h[n];c.fillRect(r[0],r[1],1,1)}!function(t){for(var c=0;c<e.vortices.length;++c){var n=[parseInt(e.vortices[c][0]),parseInt(e.vortices[c][1])];e.iselect==c?(t.strokeStyle="#880000",t.beginPath(),t.moveTo(n[0],Math.max(1,n[1]-15)),t.lineTo(n[0],Math.min(e.height,n[1]+15)),t.stroke(),t.beginPath(),t.moveTo(Math.max(1,n[0]-15),n[1]),t.lineTo(Math.min(e.width,n[0]+15),n[1]),t.stroke(),t.fillStyle="#880000",t.beginPath(),t.arc(n[0],n[1],3,0,2*Math.PI)):(t.fillStyle="#008800",t.beginPath(),t.arc(n[0],n[1],3,0,2*Math.PI)),t.fill()}}(c),function(t){if(null!=v){var c=.7*e.width;t.strokeStyle="#888888",t.beginPath(),t.moveTo(.15*e.width+v[0][0]*c,e.height/2-v[0][1]*c);for(var n=1;n<v.length;++n)t.lineTo(.15*e.width+v[n][0]*c,e.height/2-v[n][1]*c);t.stroke()}}(c);var i=t.current.getContext("2d");i.clearRect(0,0,e.width,e.height),i.drawImage(j,0,0)};return Object(n.useEffect)((function(){null!=l&&clearInterval(l),l=setInterval((function(){!function(){for(var t=0;t<h.length;++t)u(h[t]);h=h.filter((function(t){return Math.random()>.001&&isFinite(t[0])&&isFinite(t[1])&&t[0]>.2*-e.width&&t[0]<1.2*e.width&&t[1]>.2*-e.height&&t[1]<1.2*e.height}));for(var n=function(t){if("source"==e.vortices[t][3]&&e.vortices[t][2]<0){var n=parseInt(e.vortices[t][0]),r=parseInt(e.vortices[t][1]);h=h.filter((function(i){var a=i[0]-n,s=i[1]-r;return a*a+s*s>-.15*c*e.vortices[t][2]}))}},i=0;i<e.vortices.length;++i)n(i);for(var a=Math.max(.01,e.uv[0]),s=Math.max(.01,-e.uv[1]),o=3/Math.sqrt(a*a+s*s),l=e.height-e.spacing/a*e.delta;l>.2*-e.height;l-=e.spacing/a)r([0,l],o);for(var j=e.spacing/s*(1-e.delta);j<1.2*e.width;j+=e.spacing/s)r([j,e.height],o);for(var v=0;v<e.vortices.length;++v)if("source"==e.vortices[v][3]&&e.vortices[v][2]>0)for(var d=parseInt(e.vortices[v][0]),b=parseInt(e.vortices[v][1]),O=3*Math.ceil(2.07*e.vortices[v][2]/e.spacing),x=.1*e.vortices[v][2]*c,f=0;f<O;++f){var g=x+(Math.random()-.5)*c*4,p=d+g*Math.cos(2*f*Math.PI/O),m=b+g*Math.sin(2*f*Math.PI/O);console.log(p,m),r([p,m],.5*e.vortices[v][2]/1e3)}}(),d()}),30)}),[e]),Object(o.jsx)("canvas",Object(a.a)({ref:t},e))}function j(e){var t=function(t){var c=Object(s.a)(e.vortices);c[e.selected][0]=t.target.value,e.setvortices(c)},c=function(t){var c=Object(s.a)(e.vortices);c[e.selected][1]=e.height-t.target.value,e.setvortices(c)},n=function(t){var c=Object(s.a)(e.vortices);c[e.selected][2]=Math.max(-100,Math.min(100,t.target.value)),e.setvortices(c)},r=function(t){var c=Object(s.a)(e.vortices);c[e.selected][3]=t.target.value,e.setvortices(c)},i=function(){var t=Object(s.a)(e.vortices);t.splice(e.selected,0,Object(s.a)(t[e.selected])),e.setvortices(t)},a=function(){var t=Object(s.a)(e.vortices);t.splice(e.selected,1),console.log(e.selected,t.length),e.setvortices(t)};return Object(o.jsx)("div",{children:Object(o.jsx)("table",{children:Object(o.jsxs)("tbody",{children:[Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"x"}),Object(o.jsx)("th",{children:"y"}),Object(o.jsx)("th",{children:"strength"})]}),e.vortices.map((function(s,l){return Object(o.jsxs)("tr",{onFocus:function(){e.setselected(l)},onClick:function(){e.setselected(l)},onTouchStart:function(){e.setselected(l)},children:[Object(o.jsx)("td",{children:Object(o.jsx)("input",{type:"number",value:s[0],onChange:t,min:0,max:e.width,readOnly:l!=e.selected})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{type:"number",value:e.height-s[1],onChange:c,min:0,max:e.height,readOnly:l!=e.selected})}),Object(o.jsx)("td",{children:Object(o.jsx)("input",{type:"number",value:s[2],onChange:n,min:-100,max:100,readOnly:l!=e.selected})}),Object(o.jsx)("td",{children:Object(o.jsxs)("select",{value:s[3],onChange:r,children:[Object(o.jsx)("option",{value:"vortex",children:"vortex"}),Object(o.jsx)("option",{value:"source",children:"source"})]})}),Object(o.jsxs)("td",{children:[" ",l==e.selected?Object(o.jsx)("button",{onClick:i,children:"duplicate"}):Object(o.jsx)("span",{})]}),Object(o.jsxs)("td",{children:[" ",l==e.selected?Object(o.jsx)("button",{disabled:e.vortices.length<=1,onClick:a,children:"remove"}):Object(o.jsx)("span",{})]})]},l)}))]})})})}function v(e){return Object(o.jsxs)("div",{children:[Object(o.jsxs)("p",{children:[" ","u",Object(o.jsx)("sub",{children:"\u221e"})," ",Object(o.jsx)("input",{type:"number",step:.001,value:e.uv[0],onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setuv([c,e.uv[1]])},min:0,max:1}),"   ","v",Object(o.jsx)("sub",{children:"\u221e"})," ",Object(o.jsx)("input",{type:"number",step:.001,value:-e.uv[1],onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setuv([e.uv[0],-c])},min:0,max:1})," ","   ","\u03b4"," ",Object(o.jsx)("input",{type:"number",step:.01,value:e.delta,onChange:function(t){var c=Math.max(0,Math.min(1,t.target.value));e.setdelta(c)},min:0,max:1})]}),Object(o.jsxs)("p",{children:[" naca ",Object(o.jsx)("input",{type:"text",value:e.airfoil,onChange:function(t){e.setairfoil(t.target.value)},min:0,max:1})]})]})}function d(){var e=[1280,720],t=Object(n.useState)([[e[0]/2,e[1]/2,100,"vortex"]]),c=Object(i.a)(t,2),r=c[0],a=c[1],s=Object(n.useState)(0),l=Object(i.a)(s,2),h=l[0],d=l[1],b=Object(n.useState)([1,0]),O=Object(i.a)(b,2),x=O[0],f=O[1],g=Object(n.useState)(0),p=Object(i.a)(g,2),m=p[0],M=p[1],y=Object(n.useState)(""),w=Object(i.a)(y,2),S=w[0],I=w[1];return Object(o.jsx)("div",{className:"FlowBuilder",children:Object(o.jsx)("table",{children:Object(o.jsxs)("tbody",{children:[Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{rowSpan:2,children:Object(o.jsx)("img",{src:"qi.jpg"})}),Object(o.jsx)("td",{children:Object(o.jsx)(j,{vortices:r,selected:h,setvortices:a,setselected:d,width:e[0],height:e[1]})}),Object(o.jsx)("td",{rowSpan:2,children:Object(o.jsx)("img",{src:"qi.jpg"})})]}),Object(o.jsx)("tr",{children:Object(o.jsx)("td",{children:Object(o.jsx)(v,{uv:x,setuv:f,delta:m,setdelta:M,airfoil:S,setairfoil:I})})}),Object(o.jsx)("tr",{children:Object(o.jsx)("td",{colSpan:3,children:Object(o.jsx)(u,{width:e[0],height:e[1],uv:x,spacing:20,u0:[1,0],vortices:r,iselect:h,delta:m,airfoil:S})})})]})})})}var b=document.getElementById("root");Object(r.createRoot)(b).render(Object(o.jsx)(n.StrictMode,{children:Object(o.jsx)(d,{})}))},5:function(e,t,c){}},[[19,1,2]]]);
//# sourceMappingURL=main.3390dd3f.chunk.js.map