{"version":3,"sources":["FlowCanvas.js","Airfoil.js","VortexControl.js","FreestreamControl.js","FlowBuilder.js","index.js"],"names":["loop","particles","FlowCanvas","props","canvasRef","useRef","dt","addParticle","xy","delta","push","Math","random","ddt","dxdt","uv","dydt","i","vortices","length","vort","dx","dy","r2","advance","ddt0","ddt1","canvas2","document","createElement","width","height","airfoil","code","toString","camber","parseInt","high","thick","substr","isNaN","thickFun","x","sqrt","camberFun","denom","round","xArray","Array","keys","map","reverse","points","splice","Airfoil","drawMain","ctx","getContext","clearRect","fillStyle","fillRect","iselect","strokeStyle","beginPath","moveTo","max","lineTo","min","stroke","arc","PI","fill","drawVortices","scale","drawAirfoil","ctx1","current","drawImage","useEffect","clearInterval","setInterval","filter","isFinite","x0","y0","u0","v0","noise","y","spacing","nj","ceil","rad0","j","rad","cos","sin","console","log","computeMain","ref","VortexControl","changex","event","selected","target","value","setvortices","changey","changeStrength","changeType","duplicate","remove","vortex","iVortex","onFocus","setselected","onClick","onTouchStart","type","onChange","readOnly","disabled","FreestreamControl","step","u","setuv","v","d","setdelta","setairfoil","FlowBuilder","canvasSize","useState","setVortices","setSelected","className","rowSpan","src","colSpan","rootElement","getElementById","createRoot","render"],"mappings":"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","file":"static/js/main.3390dd3f.chunk.js","sourcesContent":["import { useEffect, useRef } from \"react\";\r\nimport Airfoil from \"./Airfoil\";\r\nimport \"./styles.css\";\r\n\r\nlet loop = null;\r\nlet particles = [[100, 100]];\r\n\r\nexport default function FlowCanvas(props) {\r\n  const canvasRef = useRef(null);\r\n  const dt = 1.5;\r\n\r\n  const addParticle = (xy, delta) => {\r\n    particles.push([\r\n      xy[0] + delta * (Math.random() - 0.5),\r\n      xy[1] + delta * (Math.random() - 0.5),\r\n    ]);\r\n  };\r\n\r\n  const ddt = (xy) => {\r\n    let dxdt = props.uv[0];\r\n    let dydt = props.uv[1];\r\n    for (let i = 0; i < props.vortices.length; ++i) {\r\n      let vort = props.vortices[i];\r\n      let dx = (xy[0] - vort[0]) / 100;\r\n      let dy = (xy[1] - vort[1]) / 100;\r\n      let r2 = dx * dx + dy * dy;\r\n      if (vort[3] == \"source\") {\r\n        dxdt += (vort[2] * dx) / 100 / r2;\r\n        dydt += (vort[2] * dy) / 100 / r2;\r\n      } else {\r\n        dxdt += (vort[2] * dy) / 100 / r2;\r\n        dydt -= (vort[2] * dx) / 100 / r2;\r\n      }\r\n    }\r\n    return [dxdt, dydt];\r\n  };\r\n\r\n  const advance = (xy) => {\r\n    let ddt0 = ddt(xy);\r\n    let ddt1 = ddt([xy[0] + (ddt0[0] * dt) / 2, xy[1] + (ddt0[1] * dt) / 2]);\r\n    xy[0] += ddt1[0] * dt;\r\n    xy[1] += ddt1[1] * dt;\r\n  };\r\n\r\n  const computeMain = () => {\r\n    for (let i = 0; i < particles.length; ++i) {\r\n      advance(particles[i]);\r\n    }\r\n    particles = particles.filter(\r\n      (xy) =>\r\n        Math.random() > 0.001 &&\r\n        isFinite(xy[0]) &&\r\n        isFinite(xy[1]) &&\r\n        xy[0] > -props.width * 0.2 &&\r\n        xy[0] < props.width * 1.2 &&\r\n        xy[1] > -props.height * 0.2 &&\r\n        xy[1] < props.height * 1.2\r\n    );\r\n    for (let i = 0; i < props.vortices.length; ++i) {\r\n      if (props.vortices[i][3] == \"source\" && props.vortices[i][2] < 0) {\r\n        const x0 = parseInt(props.vortices[i][0]);\r\n        const y0 = parseInt(props.vortices[i][1]);\r\n        particles = particles.filter((xy) => {\r\n          let dx = xy[0] - x0;\r\n          let dy = xy[1] - y0;\r\n          return dx * dx + dy * dy > -0.15 * dt * props.vortices[i][2];\r\n        });\r\n      }\r\n    }\r\n    let u0 = Math.max(0.01, props.uv[0]);\r\n    let v0 = Math.max(0.01, -props.uv[1]);\r\n    let noise = 3.0 / Math.sqrt(u0 * u0 + v0 * v0);\r\n    for (\r\n      let y = props.height - (props.spacing / u0) * props.delta;\r\n      y > -props.height * 0.2;\r\n      y -= props.spacing / u0\r\n    ) {\r\n      addParticle([0, y], noise);\r\n    }\r\n    for (\r\n      let x = (props.spacing / v0) * (1 - props.delta);\r\n      x < props.width * 1.2;\r\n      x += props.spacing / v0\r\n    ) {\r\n      addParticle([x, props.height], noise);\r\n    }\r\n    for (let i = 0; i < props.vortices.length; ++i) {\r\n      if (props.vortices[i][3] == \"source\" && props.vortices[i][2] > 0) {\r\n        const x0 = parseInt(props.vortices[i][0]);\r\n        const y0 = parseInt(props.vortices[i][1]);\r\n        let nj = Math.ceil((props.vortices[i][2] * 2.07) / props.spacing) * 3;\r\n        let rad0 = props.vortices[i][2] * 0.1 * dt;\r\n        for (let j = 0; j < nj; ++j) {\r\n          let rad = rad0 + (Math.random() - 0.5) * dt * 4;\r\n          let x = x0 + rad * Math.cos((j * 2 * Math.PI) / nj);\r\n          let y = y0 + rad * Math.sin((j * 2 * Math.PI) / nj);\r\n          console.log(x, y);\r\n          addParticle([x, y], (0.5 * props.vortices[i][2]) / 1000);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  let canvas2 = document.createElement(\"canvas\");\r\n  canvas2.width = props.width;\r\n  canvas2.height = props.height;\r\n\r\n  const drawVortices = (ctx) => {\r\n    for (let i = 0; i < props.vortices.length; ++i) {\r\n      const xy = [\r\n        parseInt(props.vortices[i][0]),\r\n        parseInt(props.vortices[i][1]),\r\n      ];\r\n      if (props.iselect == i) {\r\n        ctx.strokeStyle = \"#880000\";\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(xy[0], Math.max(1, xy[1] - 15));\r\n        ctx.lineTo(xy[0], Math.min(props.height, xy[1] + 15));\r\n        ctx.stroke();\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(Math.max(1, xy[0] - 15), xy[1]);\r\n        ctx.lineTo(Math.min(props.width, xy[0] + 15), xy[1]);\r\n        ctx.stroke();\r\n\r\n        ctx.fillStyle = \"#880000\";\r\n        ctx.beginPath();\r\n        ctx.arc(xy[0], xy[1], 3, 0, 2 * Math.PI);\r\n      } else {\r\n        ctx.fillStyle = \"#008800\";\r\n        ctx.beginPath();\r\n        ctx.arc(xy[0], xy[1], 3, 0, 2 * Math.PI);\r\n      }\r\n      ctx.fill();\r\n    }\r\n  };\r\n\r\n  const airfoil = Airfoil(props.airfoil);\r\n\r\n  const drawAirfoil = (ctx) => {\r\n    if (airfoil == null) return;\r\n    const scale = props.width * 0.7;\r\n    ctx.strokeStyle = \"#888888\";\r\n    ctx.beginPath();\r\n    ctx.moveTo(\r\n      props.width * 0.15 + airfoil[0][0] * scale,\r\n      props.height / 2 - airfoil[0][1] * scale\r\n    );\r\n    for (let i = 1; i < airfoil.length; ++i) {\r\n      ctx.lineTo(\r\n        props.width * 0.15 + airfoil[i][0] * scale,\r\n        props.height / 2 - airfoil[i][1] * scale\r\n      );\r\n    }\r\n    ctx.stroke();\r\n  };\r\n\r\n  const drawMain = () => {\r\n    let ctx = canvas2.getContext(\"2d\");\r\n    ctx.clearRect(0, 0, props.width, props.height);\r\n    ctx.fillStyle = \"#000000\";\r\n    for (let i = 0; i < particles.length; ++i) {\r\n      let xy = particles[i];\r\n      ctx.fillRect(xy[0], xy[1], 1, 1);\r\n    }\r\n\r\n    drawVortices(ctx);\r\n    drawAirfoil(ctx);\r\n\r\n    const canvas = canvasRef.current;\r\n    const ctx1 = canvas.getContext(\"2d\");\r\n    ctx1.clearRect(0, 0, props.width, props.height);\r\n    ctx1.drawImage(canvas2, 0, 0);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (loop != null) clearInterval(loop);\r\n    loop = setInterval(() => {\r\n      computeMain();\r\n      drawMain();\r\n    }, 30);\r\n  }, [props]);\r\n\r\n  return <canvas ref={canvasRef} {...props} />;\r\n}\r\n","export default function Airfoil(code) {\r\n  if (code.toString().length == 4) {\r\n    const camber = parseInt(code.toString()[0]) / 10;\r\n    const high = parseInt(code.toString()[1]) / 10;\r\n    const thick = parseInt(code.toString().substr(2)) / 100;\r\n    if (isNaN(camber) || isNaN(high) || isNaN(thick)) return null;\r\n\r\n    const thickFun = (x) =>\r\n      5 *\r\n      thick *\r\n      (0.2969 * Math.sqrt(x) -\r\n        0.126 * x -\r\n        0.3516 * x * x +\r\n        0.2843 * x * x * x -\r\n        0.1015 * x * x * x * x);\r\n\r\n    const camberFun = (x) =>\r\n      x <= high\r\n        ? ((camber * camber) / (high * high)) * (2 * high * x - x * x)\r\n        : ((camber * camber) / ((1 - high) * (1 - high))) *\r\n          (1 - 2 * high + 2 * high * x - x * x);\r\n\r\n    const num = 6;\r\n    const denom = Math.round(num / thick);\r\n    const iArray = [...Array(2 * denom + 1).keys()];\r\n    let xArray = iArray.map(\r\n      (i) => ((i / denom) * (i / denom)) / (2 + i / denom)\r\n    );\r\n    xArray.reverse();\r\n    let points = xArray.map((x) => [x, camberFun(x) + thickFun(x)]);\r\n    xArray.reverse();\r\n    xArray.splice(0, 1);\r\n    points.push(...xArray.map((x) => [x, camberFun(x) - thickFun(x)]));\r\n    return points;\r\n  } else return null;\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\nimport \"./styles.css\";\r\n\r\nexport default function VortexControl(props) {\r\n  const changex = (event) => {\r\n    let vortices = [...props.vortices];\r\n    vortices[props.selected][0] = event.target.value;\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  const changey = (event) => {\r\n    let vortices = [...props.vortices];\r\n    vortices[props.selected][1] = props.height - event.target.value;\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  const changeStrength = (event) => {\r\n    let vortices = [...props.vortices];\r\n    vortices[props.selected][2] = Math.max(\r\n      -100,\r\n      Math.min(100, event.target.value)\r\n    );\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  const changeType = (event) => {\r\n    let vortices = [...props.vortices];\r\n    vortices[props.selected][3] = event.target.value;\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  const duplicate = () => {\r\n    let vortices = [...props.vortices];\r\n    vortices.splice(props.selected, 0, [...vortices[props.selected]]);\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  const remove = () => {\r\n    let vortices = [...props.vortices];\r\n    vortices.splice(props.selected, 1);\r\n    console.log(props.selected, vortices.length);\r\n    props.setvortices(vortices);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <table>\r\n        <tbody>\r\n          <tr>\r\n            <th>x</th>\r\n            <th>y</th>\r\n            <th>strength</th>\r\n          </tr>\r\n\r\n          {props.vortices.map((vortex, iVortex) => (\r\n            <tr\r\n              key={iVortex}\r\n              onFocus={() => {\r\n                props.setselected(iVortex);\r\n              }}\r\n              onClick={() => {\r\n                props.setselected(iVortex);\r\n              }}\r\n              onTouchStart={() => {\r\n                props.setselected(iVortex);\r\n              }}\r\n            >\r\n              <td>\r\n                <input\r\n                  type=\"number\"\r\n                  value={vortex[0]}\r\n                  onChange={changex}\r\n                  min={0}\r\n                  max={props.width}\r\n                  readOnly={iVortex != props.selected}\r\n                />\r\n              </td>\r\n              <td>\r\n                <input\r\n                  type=\"number\"\r\n                  value={props.height - vortex[1]}\r\n                  onChange={changey}\r\n                  min={0}\r\n                  max={props.height}\r\n                  readOnly={iVortex != props.selected}\r\n                />\r\n              </td>\r\n              <td>\r\n                <input\r\n                  type=\"number\"\r\n                  value={vortex[2]}\r\n                  onChange={changeStrength}\r\n                  min={-100}\r\n                  max={100}\r\n                  readOnly={iVortex != props.selected}\r\n                />\r\n              </td>\r\n              <td>\r\n                <select value={vortex[3]} onChange={changeType}>\r\n                  <option value=\"vortex\">vortex</option>\r\n                  <option value=\"source\">source</option>\r\n                </select>\r\n              </td>\r\n              <td>\r\n                {\" \"}\r\n                {iVortex == props.selected ? (\r\n                  <button onClick={duplicate}>duplicate</button>\r\n                ) : (\r\n                  <span />\r\n                )}\r\n              </td>\r\n              <td>\r\n                {\" \"}\r\n                {iVortex == props.selected ? (\r\n                  <button\r\n                    disabled={props.vortices.length <= 1}\r\n                    onClick={remove}\r\n                  >\r\n                    remove\r\n                  </button>\r\n                ) : (\r\n                  <span />\r\n                )}\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\nimport \"./styles.css\";\r\n\r\nexport default function FreestreamControl(props) {\r\n  return (\r\n    <div>\r\n      <p>\r\n        {\" \"}\r\n        u<sub>&infin;</sub>{\" \"}\r\n        <input\r\n          type=\"number\"\r\n          step={0.001}\r\n          value={props.uv[0]}\r\n          onChange={(event) => {\r\n            const u = Math.max(0, Math.min(1, event.target.value));\r\n            props.setuv([u, props.uv[1]]);\r\n          }}\r\n          min={0}\r\n          max={1}\r\n        />\r\n        {\"   \"}v<sub>&infin;</sub>{\" \"}\r\n        <input\r\n          type=\"number\"\r\n          step={0.001}\r\n          value={-props.uv[1]}\r\n          onChange={(event) => {\r\n            const v = Math.max(0, Math.min(1, event.target.value));\r\n            props.setuv([props.uv[0], -v]);\r\n          }}\r\n          min={0}\r\n          max={1}\r\n        />{\" \"}\r\n        {\"   \"}&delta;{\" \"}\r\n        <input\r\n          type=\"number\"\r\n          step={0.01}\r\n          value={props.delta}\r\n          onChange={(event) => {\r\n            const d = Math.max(0, Math.min(1, event.target.value));\r\n            props.setdelta(d);\r\n          }}\r\n          min={0}\r\n          max={1}\r\n        />\r\n      </p>\r\n      <p>\r\n        {\" naca \"}\r\n        <input\r\n          type=\"text\"\r\n          value={props.airfoil}\r\n          onChange={(event) => {\r\n            props.setairfoil(event.target.value);\r\n          }}\r\n          min={0}\r\n          max={1}\r\n        />\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n","import { useState } from \"react\";\nimport FlowCanvas from \"./FlowCanvas\";\nimport VortexControl from \"./VortexControl\";\nimport FreestreamControl from \"./FreestreamControl\";\nimport \"./styles.css\";\n\nexport default function FlowBuilder() {\n  const canvasSize = [1280, 720];\n  const [vortices, setVortices] = useState([\n    [canvasSize[0] / 2, canvasSize[1] / 2, 100, \"vortex\"],\n  ]);\n  const [selected, setSelected] = useState(0);\n  const [uv, setuv] = useState([1.0, 0.0]);\n  const [delta, setdelta] = useState(0.0);\n  const [airfoil, setairfoil] = useState(\"\");\n\n  return (\n    <div className=\"FlowBuilder\">\n      <table>\n        <tbody>\n          <tr>\n            <td rowSpan={2}>\n              <img src=\"qi.jpg\" />\n            </td>\n            <td>\n              <VortexControl\n                vortices={vortices}\n                selected={selected}\n                setvortices={setVortices}\n                setselected={setSelected}\n                width={canvasSize[0]}\n                height={canvasSize[1]}\n              />\n            </td>\n            <td rowSpan={2}>\n              <img src=\"qi.jpg\" />\n            </td>\n          </tr>\n          <tr>\n            <td>\n              <FreestreamControl\n                uv={uv}\n                setuv={setuv}\n                delta={delta}\n                setdelta={setdelta}\n                airfoil={airfoil}\n                setairfoil={setairfoil}\n              />\n            </td>\n          </tr>\n          <tr>\n            <td colSpan={3}>\n              <FlowCanvas\n                width={canvasSize[0]}\n                height={canvasSize[1]}\n                uv={uv}\n                spacing={20}\n                u0={[1.0, 0.0]}\n                vortices={vortices}\n                iselect={selected}\n                delta={delta}\n                airfoil={airfoil}\n              />\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","import { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\n\nimport FlowBuilder from \"./FlowBuilder\";\n\nconst rootElement = document.getElementById(\"root\");\nconst root = createRoot(rootElement);\n\nroot.render(\n  <StrictMode>\n    <FlowBuilder />\n  </StrictMode>\n);\n"],"sourceRoot":""}