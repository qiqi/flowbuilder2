(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{11:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var i=n(0),c=n(20),r=n(16),s=n(3),a=n(4),o=n(5);n(11);var l=n(2),u=null,h=[[100,100]];function j(t){var e=Object(i.useRef)(null),n=1.5,c=function(e,n){return[(.15+parseFloat(e)/1e3*.7)*t.width,.5*t.height-parseFloat(n)/1e3*.7*t.width]},r=function(t,e){h.push([t[0]+e*(Math.random()-.5),t[1]+e*(Math.random()-.5)])},s=function(e){for(var n=t.uv[0],i=-t.uv[1],r=0;r<t.vortices.length;++r){var s=t.vortices[r],o=c(s[0],s[1]),l=Object(a.a)(o,2),u=l[0],h=l[1],j=(e[0]-u)/100,d=(e[1]-h)/100,v=j*j+d*d;"source"==s[3]?(n+=s[2]*j/100/v,i+=s[2]*d/100/v):(n+=s[2]*d/100/v,i-=s[2]*j/100/v)}return[n,i]},j=function(t){var e=s(t),i=s([t[0]+e[0]*n/2,t[1]+e[1]*n/2]);t[0]+=i[0]*n,t[1]+=i[1]*n},d=document.createElement("canvas");d.width=t.width,d.height=t.height;var v=function(t){if(4==t.toString().length){var e=parseInt(t.toString()[0])/100,n=parseInt(t.toString()[1])/10,i=parseInt(t.toString().substr(2))/100;if(isNaN(e)||isNaN(n)||isNaN(i))return null;var c=function(t){return 5*i*(.2969*Math.sqrt(t)-.126*t-.3516*t*t+.2843*t*t*t-.1015*t*t*t*t)},r=function(t){return t<=n?e/(n*n)*(2*n*t-t*t):e/((1-n)*(1-n))*(1-2*n+2*n*t-t*t)},s=Math.round(6/i),a=Object(o.a)(Array(2*s+1).keys()).map((function(t){return t/s*(t/s)/(2+t/s)}));a.reverse();var l=a.map((function(t){return[t,r(t)+c(t)]}));return a.reverse(),a.splice(0,1),l.push.apply(l,Object(o.a)(a.map((function(t){return[t,r(t)-c(t)]})))),l}return null}(t.airfoil),b=function(){var n=d.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#000000";for(var i=0;i<h.length;++i){var r=h[i];n.fillRect(r[0],r[1],1,1)}!function(e){for(var n=0;n<t.vortices.length;++n){var i=c(t.vortices[n][0],t.vortices[n][1]),r=Object(a.a)(i,2),s=r[0],o=r[1];t.iselect==n?(e.strokeStyle="#880000",e.beginPath(),e.moveTo(s,Math.max(1,o-15)),e.lineTo(s,Math.min(t.height,o+15)),e.stroke(),e.beginPath(),e.moveTo(Math.max(1,s-15),o),e.lineTo(Math.min(t.width,s+15),o),e.stroke(),e.fillStyle="#880000",e.beginPath(),e.arc(s,o,3,0,2*Math.PI)):(e.fillStyle="#008800",e.beginPath(),e.arc(s,o,3,0,2*Math.PI)),e.fill()}}(n),function(e){if(null!=v){var n=.7*t.width;e.strokeStyle="#888888",e.beginPath(),e.moveTo(.15*t.width+v[0][0]*n,t.height/2-v[0][1]*n);for(var i=1;i<v.length;++i)e.lineTo(.15*t.width+v[i][0]*n,t.height/2-v[i][1]*n);e.stroke()}}(n);var s=e.current.getContext("2d");s.clearRect(0,0,t.width,t.height),s.drawImage(d,0,0)};Object(i.useEffect)((function(){null!=u&&clearInterval(u),u=setInterval((function(){!function(){for(var e=0;e<h.length;++e)j(h[e]);h=h.filter((function(e){return Math.random()>.001&&isFinite(e[0])&&isFinite(e[1])&&e[0]>.2*-t.width&&e[0]<1.2*t.width&&e[1]>.2*-t.height&&e[1]<1.2*t.height}));for(var i=function(e){if("source"==t.vortices[e][3]&&t.vortices[e][2]<0){var i=c(t.vortices[e][0],t.vortices[e][1]),r=Object(a.a)(i,2),s=r[0],o=r[1];h=h.filter((function(i){var c=i[0]-s,r=i[1]-o;return c*c+r*r>-.15*n*t.vortices[e][2]}))}},s=0;s<t.vortices.length;++s)i(s);for(var o=Math.max(.01,t.uv[0]),l=Math.max(.01,-t.uv[1]),u=3/Math.sqrt(o*o+l*l),d=t.height-t.spacing/o*t.delta;d>.2*-t.height;d-=t.spacing/o)r([0,d],u);for(var v=t.spacing/l*(1-t.delta);v<1.2*t.width;v+=t.spacing/l)r([v,t.height],u);for(var b=0;b<t.vortices.length;++b)if("source"==t.vortices[b][3]&&t.vortices[b][2]>0)for(var f=c(t.vortices[b][0],t.vortices[b][1]),O=Object(a.a)(f,2),g=O[0],x=O[1],p=3*Math.ceil(2.07*t.vortices[b][2]/t.spacing),m=.1*t.vortices[b][2]*n,M=0;M<p;++M){var S=m+(Math.random()-.5)*n*4,w=g+S*Math.cos(2*M*Math.PI/p),y=x+S*Math.sin(2*M*Math.PI/p);r([w,y],.5*t.vortices[b][2]/1e3)}}(),b()}),30)}),[t]);return Object(l.jsx)("canvas",{ref:e,onClick:function(t){var n=e.current,i=n.getBoundingClientRect(),c=n.width/i.width,s=n.height/i.height,a=(t.clientX-i.left)*c,o=(t.clientY-i.top)*s;if(Math.random()<.5)for(var l=10,u=-10;u<l;u++)r([a-l,o+u],0),r([a+l,o+u],0),r([a+u,o-l],0),r([a+u,o+l],0);else for(var h=0;h<14;h++)r([a-h,o-14+h],0),r([a+h,o-14+h],0),r([a-h,o+14-h],0),r([a+h,o+14-h],0)},onMouseMove:function(n){var i=e.current,c=i.getBoundingClientRect(),r=i.width/c.width,o=i.height/c.height,l=(n.clientX-c.left)*r,u=(n.clientY-c.top)*o,h=s([l,u]),j=Object(a.a)(h,2),d=j[0],v=j[1],b=function(e,n){return[(e/t.width-.15)/.7*1e3,(.5*t.height-n)/(.7*t.width)*1e3]}(l,u),f=Object(a.a)(b,2),O=f[0],g=f[1],x=.5*(t.uv[0]*t.uv[0]+t.uv[1]*t.uv[1]-d*d-v*v);t.setmousestate([O,g,d,-v,x])},onMouseLeave:function(){t.setmousestate([])},width:t.width,height:t.height})}function d(t){var e=function(e,n){var i=Object(o.a)(t.vortices),c=parseFloat(e.target.value);isNaN(c)||(n(i[t.selected],c),t.setvortices(i))},n=function(t){return e(t,(function(t,e){t[0]=e}))},i=function(t){return e(t,(function(t,e){t[1]=e}))},c=function(t){return e(t,(function(t,e){t[2]=e}))},r=function(e){var n=Object(o.a)(t.vortices);n[t.selected][3]=e.target.value,t.setvortices(n)},s=function(){var e=Object(o.a)(t.vortices);e.splice(t.selected,0,Object(o.a)(e[t.selected])),t.setvortices(e)},a=function(){var e=Object(o.a)(t.vortices);e.splice(t.selected,1),console.log(t.selected,e.length),t.setvortices(e)};return Object(l.jsx)("div",{children:Object(l.jsx)("table",{children:Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"x"}),Object(l.jsx)("th",{children:"y"}),Object(l.jsx)("th",{children:"strength"})]}),t.vortices.map((function(e,o){return Object(l.jsxs)("tr",{onFocus:function(){t.setselected(o)},onClick:function(){t.setselected(o)},onTouchStart:function(){t.setselected(o)},children:[Object(l.jsx)("td",{children:Object(l.jsx)("input",{type:"number",value:e[0],onChange:n,min:-500,max:1500,readOnly:o!=t.selected})}),Object(l.jsx)("td",{children:Object(l.jsx)("input",{type:"number",value:e[1],onChange:i,min:-500,max:500,readOnly:o!=t.selected})}),Object(l.jsx)("td",{children:Object(l.jsx)("input",{type:"number",value:e[2],onChange:c,min:-100,max:100,readOnly:o!=t.selected})}),Object(l.jsx)("td",{children:Object(l.jsxs)("select",{value:e[3],onChange:r,children:[Object(l.jsx)("option",{value:"vortex",children:"vortex"}),Object(l.jsx)("option",{value:"source",children:"source"})]})}),Object(l.jsxs)("td",{children:[" ",o==t.selected?Object(l.jsx)("button",{onClick:s,children:"duplicate"}):Object(l.jsx)("span",{})]}),Object(l.jsxs)("td",{children:[" ",o==t.selected?Object(l.jsx)("button",{disabled:t.vortices.length<=1,onClick:a,children:"remove"}):Object(l.jsx)("span",{})]})]},o)}))]})})})}function v(t){return Object(l.jsxs)("div",{children:[Object(l.jsxs)("p",{children:[" ","u",Object(l.jsx)("sub",{children:"\u221e"})," ",Object(l.jsx)("input",{type:"number",step:.001,value:t.uv[0],onChange:function(e){var n=Math.max(0,Math.min(1,e.target.value));t.setuv([n,t.uv[1]])},min:0,max:1}),"   ","v",Object(l.jsx)("sub",{children:"\u221e"})," ",Object(l.jsx)("input",{type:"number",step:.001,value:t.uv[1],onChange:function(e){var n=Math.max(0,Math.min(1,e.target.value));t.setuv([t.uv[0],n])},min:0,max:1})," ","   ","\u03b4"," ",Object(l.jsx)("input",{type:"number",step:.01,value:t.delta,onChange:function(e){var n=Math.max(0,Math.min(1,e.target.value));t.setdelta(n)},min:0,max:1})]}),Object(l.jsxs)("p",{children:[" naca ",Object(l.jsx)("input",{type:"text",value:t.airfoil,onChange:function(e){t.setairfoil(e.target.value)},min:0,max:1})]})]})}function b(t){return 0==t.mousestate.length?Object(l.jsx)("div",{}):Object(l.jsxs)("div",{children:[Object(l.jsxs)("p",{children:["x=",t.mousestate[0].toFixed(0)]}),Object(l.jsxs)("p",{children:["y=",t.mousestate[1].toFixed(0)]}),Object(l.jsxs)("p",{children:["u=",t.mousestate[2].toFixed(2)]}),Object(l.jsxs)("p",{children:["v=",t.mousestate[3].toFixed(2)]}),Object(l.jsxs)("p",{children:["p=",t.mousestate[4].toFixed(2)]})]})}function f(){var t,e=[1280,720],n=Object(i.useState)(0),c=Object(a.a)(n,2),s=c[0],o=c[1],u=Object(i.useState)([]),h=Object(a.a)(u,2),f=h[0],O=h[1],g=Object(r.b)(),x=Object(a.a)(g,2),p=x[0],m=x[1],M=p.get("v"),S=Object(i.useState)(null==(t=M)||0==t.toString().split("~").length?[[500,0,100,"source"]]:t.split("~").map((function(t){var e=t.split("_");return[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),e[3]]}))),w=Object(a.a)(S,2),y=w[0],C=w[1],F=p.get("uv"),k=Object(i.useState)(null==F?[1,0]:F.split("_").map(parseFloat)),I=Object(a.a)(k,2),N=I[0],P=I[1],R=parseFloat(p.get("delta")),T=Object(i.useState)(isNaN(R)?0:R),_=Object(a.a)(T,2),q=_[0],B=_[1],E=p.get("airfoil"),J=Object(i.useState)(null==E?"":E.toString()),X=Object(a.a)(J,2),Y=X[0],A=X[1];return Object(l.jsx)("table",{children:Object(l.jsxs)("tbody",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{rowSpan:2,children:Object(l.jsx)("img",{src:"qi.jpg"})}),Object(l.jsx)("td",{children:Object(l.jsx)(d,{vortices:y,selected:s,setvortices:function(t){C(t),function(t){for(var e=function(t){return t[0].toString()+"_"+t[1].toString()+"_"+t[2].toString()+"_"+t[3].toString()},n=e(t[0]),i=1;i<t.length;++i)n+="~",n+=e(t[i]);p.set("v",n),m(p)}(t)},setselected:o,width:e[0],height:e[1]})}),Object(l.jsx)("td",{rowSpan:2,width:"100px",valign:"bottom",children:Object(l.jsx)(b,{mousestate:f})}),Object(l.jsx)("td",{rowSpan:2,children:Object(l.jsx)("img",{src:"qi.jpg"})})]}),Object(l.jsx)("tr",{children:Object(l.jsx)("td",{children:Object(l.jsx)(v,{uv:N,setuv:function(t){P(t),function(t){p.set("uv",t[0].toString()+"_"+t[1].toString()),m(p)}(t)},delta:q,setdelta:function(t){B(t),function(t){p.set("delta",t.toString()),m(p)}(t)},airfoil:Y,setairfoil:function(t){A(t),function(t){p.set("airfoil",t.toString()),m(p)}(t)}})})}),Object(l.jsx)("tr",{children:Object(l.jsx)("td",{colSpan:4,children:Object(l.jsx)(j,{width:e[0],height:e[1],uv:N,spacing:20,u0:[1,0],vortices:y,iselect:s,delta:q,airfoil:Y,setmousestate:O})})})]})})}var O=document.getElementById("root"),g=Object(c.createRoot)(O),x=Object(r.a)([{path:"*",element:Object(l.jsx)(f,{})}]);g.render(Object(l.jsx)(i.StrictMode,{children:Object(l.jsx)(s.b,{router:x})}))}},[[30,1,2]]]);
//# sourceMappingURL=main.79fa5346.chunk.js.map